# 修改下行域名配置
## 接口描述
修改指定直播空间中某个下行域名的配置

## 接口信息
- **请求方法**: PATCH
- **请求路径**: /
- **请求参数**:
  - **domainConfig** (string) - 域名配置，必需
  - **name** (string) - 域名，必需  
    示例值: `www.example.com`
  - **fields** (string) - 指定要更新的字段，可选。支持以下字段: `ipLimit`, `httpResponseHeader`, `auth`, `refererSecurity`, `protocolForbiddens`  
    示例值: `iplimit,httpResponseHeader`


## 请求参数
### Header 参数
|   参数名	|   位置	 |   类型	   |必填	 |示例值	|描述|
|:--------- |:--------|:-----------|:-----|:---------|:---|
|   Host     |	Header|	string   |	是   | `<bucket>`.mls.cn-east-1.qiniumiku.com|	请求的服务域名|
|   Authorization | Header | string | 是 | `<QiniuToken>` |  管理凭证 QiniuToken |

### Bod y参数 (application/json)
示例：
```json
{
    "type":"liveRtmp",
    "auth":{
        "key":"QXV0aG9yaXphdGlvbg"
    },
    "certificateID":"my-cert"
}
```
### 参数
| 参数名称 | 类型 | 说明 | 是否必需 |
|------|------|------|----------|
| enable | boolean | 域名是否启用 | 可选 |
| type | string | 域名类型 | 可选 |
| auth | object | 防盗链配置参数信息 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 功能开关 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ type | string | 类型 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ primaryKey | string | 主 key | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ secondaryKey | string | 从 key | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ expireSeconds | integer | 防盗链过期时间秒数 | 必需 |
| thirdAuth | object | 访问 URL 进行回源鉴权 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 功能开关 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ authUrl | string | 鉴权 URL | 必需 |
| streamConf | object | 流配置 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ gopCacheMode | integer | 流媒体服务端 GOP Cache 模式（0: 秒开, 1: 低延迟, 2: las） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ gopCacheNum | integer | 缓存 GOP 的数目 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enableTimestampModify | boolean | 是否开启时间戳修改 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ disableHttpChunk | boolean | 关闭 FLV Chunk 模式 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ hlsType | integer | HLS 的服务模式（0&1: unused, 2: 中心切片, 3: 边缘切片） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enableDelayPlay | boolean | 是否允许延时播放 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ expectedDelayTimeSecond | integer | 默认延时播放时长（秒） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ enableBackupOriginUrl | boolean | 是否使能备用回源地址（true: 开启, false: 关闭） | 可选 |
| origin | object | 回源配置 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 是否开启回源拉流 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ url | string | 回源地址，可配置完整 URL 或回源域名 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ urlBackup | string | 备用回源地址，可配置完整 URL 或回源域名 | 可选 |
| app | string | 回源 app | 可选 |
| certificateID | string | 证书 ID | 可选 |
| urlRewrites | array [object] | URL 改写规则，格式为正则表达式 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ pattern | string | 匹配规则 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ replace | string | 改写规则 | 必需 |
| forward | object | 推流转推域名 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 转推开关 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ items | array [object] | 转推目的配置数组 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;├─ domain | string | 转发到此域名 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─ url | string | 转发到此 URL | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ redirect | integer | 302 比例（<=0: 默认关闭, >0: 按比例开启） | 可选 |
| ipLimit | object | IP 黑白名单 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ whitelist | array[string] | 白名单 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ blacklist | array[string] | 黑名单 | 可选 |
| httpResponseHeader | object | HTTP 响应头 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ ${key} | array[string] | 响应头配置 | 可选 |
| protocolForbiddens | array[string] | 协议禁播，只针对通用类型（可选值: "hls", "rtmp", "flv"） | 可选 |
| refererSecurity | object | Referer 防盗链 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ type | string | 防盗链类型（"black" 黑名单, "white" 白名单, "" 关闭鉴权） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ includeEmpty | integer | 校验模式（true: 黑名单模式失败, 白名单模式成功） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ list | array[string] | 支持域名/IP, 可泛域名匹配（例如 *.qiniu.com） | 可选 |
| httpsEnable | boolean | 是否开启 HTTPS | 可选 |
| redirect | integer | 302 比例 | 可选 |


## 访问域名
```go
<bucket>.mls.cn-east-1.qiniumiku.com
```

## 认证授权
```go
Authorization: <QiniuToken>
```
- **QiniuToken 详细描述请查阅**: [这里](/docs/public/请求鉴权)

## 请求示例
```http
PATCH /?domainConfig&name=www.example.com&fields=iplimit HTTP/1.1
Host: <bucket>.mls.cn-east-1.qiniumiku.com
Authorization: <QiniuToken>
Content-Type: application/json

{
    "type":"liveRtmp",
    "auth":{
        "key":"QXV0aG9yaXphdGlvbg"
    },
    "certificateID":"my-cert"
}
```
## 返回响应

### 响应状态码
- **请查阅**: [这里](/docs/public/错误返回)

### 响应示例
```json
{
    "enable": true,
    "bucketId": "my-bucket",
    "region": "ap-1",
    "domain": "www.example.com",
    "cname": "www.example.com.publish.mikudns.com",
    "type": "pushRtmp",
    "thirdAuth": {
        "enable": false,
        "authUrl": "www.example.com"
    },
    "auth": {
        "enable": true,
        "primaryKey": "QXV0aG9yaXphdGlvbg",
        "secondaryKey": "QXV0aG9yaXphdGlvbg",
        "expireSeconds": 120
    },
    "streamConf": {
        "lastModified": "2019-01-01T00:00:00Z",
        "gopCacheMode": 10,
        "gopCacheNum": 10,
        "enableTimestampModify": true,
        "disableHttpChunk": true,
        "noDataTimeout": 60,
        "hlsType": 10,
        "hlsSegmentDuration": 10,
        "hlsSegmentExpired": 10,
        "enableDelayPlay": true,
        "expectedDelayTimeSecond": 10,
        "disablePublisherBattle": true,
        "enableBackupPublish": false
    },
    "origin": {
        "enable": true,
        "type": "pushRtmp",
        "url": "http://example.com",
        "urlBackup": "",
        "timeout": 30,
        "retryTimes": 10,
        "fillowISP": true
    },
    "urlRewrites": [
        {
            "pattern": "",
            "replace": ""
        }
    ],
    "forward": {
        "enable": true,
        "item": [
            {
                "domain": "http://example.com",
                "url": "url"
            }
        ]
    },
    "refererSecurity": {
        "type": "pushRtmp",
        "list": [
            "",
            ""
        ],
        "includeEmpty": true
    },
    "certificateID": "my-cert",
    "creationDate": "2019-01-01T00:00:00Z",
    "lastModified": "2019-01-01T00:00:00Z",
    "httpsEnable": true
}
```
### 响应参数
| 参数名称 | 类型 | 说明 | 是否必需 |
|------|------|------|----------|
| bucketId | string | 空间 ID | 必需 |
| region | string | 区域 | 必需 |
| domain | string | 域名 | 必需 |
| cname | string | CNAME | 必需 |
| type | string | 域名类型 | 必需 |
| auth | object | 防盗链配置参数信息 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 功能开关 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ primaryKey | string | 主 key | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ secondaryKey | string | 从 key | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ expireSeconds | integer | 防盗链过期时间秒数 | 必需 |
| thirdAuth | object | 访问 URL 进行回源鉴权 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 功能开关 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ authUrl | string | 鉴权 URL | 必需 |
| streamConf | object | 流配置 (StreamConf) | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ gopCacheMode | integer | 流媒体服务端 GOP Cache 模式（0: 秒开, 1: 低延迟, 2: las） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ gopCacheNum | integer | 缓存 GOP 的数目 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ noDataTimeout | integer | 无数据超时断开推流（单位秒） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enableTimestampModify | boolean | 是否开启时间戳修改 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ hlsSegmentDuration | integer | 流媒体服务端 HLS 的切片大小（单位秒） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ hlsSegmentExpired | integer | 流媒体服务端 HLS 的切片缓存时间（单位秒） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enableDelayPlay | boolean | 是否允许开启延时播放 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ expectedDelayTimeSecond | integer | 默认延时播放时长（单位秒） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ lastModified | string | 最后修改时间 | 必需 |
| disableHttpChunk | boolean | 关闭 FLV chunk | 必需 |
| hlsType | integer | 流媒体服务端 HLS 的服务模式（0&1: unused, 2: 中心切片, 3: 边缘切片） | 必需 |
| disablePublisherBattle | string | 是否开启抢流，默认 false | 必需 |
| enableBackupPublish | string | 是否开启主备流，默认 false | 必需 |
| certificateID | string | 证书 ID | 必需 |
| creationDate | string | 创建时间（ISO 8601） | 必需 |
| lastModified | string | 修改时间（ISO 8601） | 可选 |
| origin | object | 回源配置 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | string | 是否开启回源拉流 | 必需 |
| urlRewrites | array [object] | URL 改写规则 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ pattern | string | 匹配规则 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ replace | string | 改写规则 | 必需 |
| forward | object | 转推配置 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 是否开启转推 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ items | array [object] | 转推配置数组 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;├─ url | string | 转推地址，转发到此 URL | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└─ domain | string | 转发到此域名 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ httpsEnable | boolean | 是否开启 HTTPS | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ redirect | integer | 302 比例（<=0: 默认关闭, >0: 按比例开启） | 可选 |
| ipLimit | object | IP 黑白名单 (IpLimit) | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ whitelist | array[string] | 白名单 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ blacklist | array[string] | 黑名单 | 可选 |
| httpResponseHeader | object | HTTP 响应头 (HttpResponseHeader) | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ ${key} | array[string] | 响应头配置 | 可选 |
| protocolForbiddens | array[string] | 协议禁播，只对通用域名生效（可选值: "hls","flv","rtmp"） | 可选 |
| refererSecurity | object | Referer 防盗链 (RefererSecurity) | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ type | string | referer 防盗链类型（"black" 黑名单, "white" 白名单, "" 关闭鉴权） | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ includeEmpty | integer | 黑白名单校验规则 | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ list | array[string] | 支持域名/IP, 支持泛域名匹配，例如 *.qiniu.com | 可选 |
