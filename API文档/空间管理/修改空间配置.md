# 修改空间配置
### 描述
修改指定空间（Bucket）的配置，包括录制、转推、回源、回调、流媒体参数、转码等。

## 接口信息
- **请求方法**: PATCH
- **请求路径**: /
- **请求参数**:
  - **config** (string) - 配置，必需
  - **region** (string) - 地区，可选  

## 请求参数
### Header 参数
|   参数名	|   位置	 |   类型	   |必填	 |示例值	|描述|
|:--------- |:--------|:-----------|:-----|:---------|:---|
|   config   |  Query | string | 否 | config | 固定参数，取值为 config |
|   Host     |	Header|	string   |	是   | `<bucket>`.mls.cn-east-1.qiniumiku.com|	请求的服务域名|
|   Authorization | Header | string | 是 | `<QiniuToken>` |  管理凭证 QiniuToken |

### Body 参数 (application/json)

示例：
```json
{
  "status": "Enabled",
  "recording": {
    "enable": true,
    "objectBucket": "test",
    "expireDays": 10,
    "segmentDuration": 5,
    "snapshot": {
      "enable": true,
      "interval": 5,
      "filename": "test",
      "format": "",
      "expireDays": 3
    }
  },
  "callbackUrl": "http://www.example.com",
  "streamConf": {
    "gopCacheMode": 0,
    "gopCacheNum": 10,
    "noDataTimeout": 10
  }
}
```
### 参数
| 参数名称 | 类型 | 说明 | 是否必需 |
|------|------|------|----------|
| status | string | 状态 | 可选 |
| recording | object |  | 可选 |
| ├─ enable | boolean | 是否开启录制功能 | 可选 |
| ├─ objectBucket | string | 录制文件保存对象空间 | 可选 |
| ├─ expireDays | integer | 录制过期时间，默认不过期 | 可选 |
| ├─ segmentDuration | integer | 录制切片时长，默认5s | 可选 |
| ├─ playbackDomain | string | 回放域名 | 可选 |
| ├─ snapshot | object |  | 可选 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ enable | boolean | 是否开启截图功能 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ interval | integer | 截图间隔,单位为s | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ filename | string | 截图文件名 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ format | string | 参考(https://developer.qiniu.com/dora/8273/the-pipe):vframe/jpg/offset/0 vframe/png/offset/0 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ expireDays | integer | 截图过期时间,默认不过期 | 必需 |
| └─ format | []string|  | 可选 |
| forward | object | 转推相关配置 | 可选 |
| ├─ enable | boolean | 是否开启转推 | 必需 |
| └─ items | []object |  | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ domain | string | 转发到此域名 |可选|
| &nbsp;&nbsp;&nbsp;&nbsp;└─ url | string | 转推地址，转发到此url |可选|
| origin | object |  | 可选 |
| ├─ enable | boolean | 是否开启回源拉流 | 必需 |
| ├─ type | string | 回源类型 | 必需 |
| ├─ url | string | 回源地址 | 必需 |
| ├─ urlBackup | string | 备用回源地址 | 必需 |
| ├─ timeout | integer | 超时时间 | 必需 |
| ├─ retryTimes | integer | 重试次数 | 必需 |
| └─ followISP | boolean |  | 必需 |
| callbackUrl | string | 回调地址 | 可选 |
| callbackEnable | boolean | 是否开启回调通知 | 可选 |
| streamConf | object |  | 可选 |
| ├─ gopCacheMode | integer | GOP cache模式，0: 秒开模式，1：低延迟模式, 2: las模式 | 可选 |
| ├─ gopCacheNum | integer | 缓存GOP数目 | 可选 |
| ├─ noDataTimeout | integer | 无数据超时断开推流，单位秒 | 可选 |
| ├─ enableTimestampModify | boolean | 是否开启修改时间戳 | 可选 |
| ├─ disableHttpChunk | boolean | 取消FLV chunk模式 | 可选 |
| ├─ hlsType | integer | HLS服务模式：0&1:unused, 2：中心切片，3：边缘切片 | 可选 |
| ├─ hlsSegmentDuration | integer | HLS切片大小，单位秒 | 可选 |
| ├─ hlsSegmentExpired | integer | HLS切片缓存时间，单位秒，默认4个segment duration | 可选 |
| ├─ enableDelayPlay | boolean | 是否允许开启延时播放 | 可选 |
| ├─ expectedDelayTimeSecond | integer | 默认延时播放时长 | 可选 |
| ├─ disablePublisherBattle | boolean | 是否开启抢流，默认false | 可选 |
| └─ enableBackupPublish | boolean | 是否开启主备流，默认false | 必需 |
| codec | object | 转码相关配置，填写的转码模板名称要提前创建好 | 可选 |
| ├─ convert | []string| 配置实时转码模板，只要有推流就启动转码 | 可选 |
| └─ passive | []string | 触发转码，首次拉流时才启动转码 | 可选 |
| refererSecurity | object |  | 可选 |
| ├─ type | string | "black" 黑名单 / "white" 白名单 / "" 关闭鉴权 | 必需 |
| ├─ includeEmpty | boolean |  | 必需 |
| └─ list | []string |  | 必需 |
| pfopSegments | - |  | - |

## 访问域名
```go
<bucket>.mls.cn-east-1.qiniumiku.com
```

## 认证授权
```go
Authorization: <QiniuToken>
```
- **QiniuToken 详细描述请查阅**: [这里](/docs/public/请求鉴权)

## 请求示例
```http
PATCH /?config HTTP/1.1
Host: test.mls.cn-east-1.qiniumiku.com
Authorization: <QiniuToken>
Content-Type: application/json

{
  "status": "Enabled",
  "recording": {
    "enable": true,
    "objectBucket": "test",
    "expireDays": 10,
    "segmentDuration": 5,
    "snapshot": {
      "enable": true,
      "interval": 5,
      "filename": "test",
      "format": "",
      "expireDays": 3
    }
  },
  "callbackUrl": "http://www.example.com",
  "streamConf": {
    "gopCacheMode": 0,
    "gopCacheNum": 10,
    "noDataTimeout": 10
  }
}
```

## 返回响应

### 响应状态码
- **请查阅**: [这里](/docs/public/错误返回)

### 响应示例

```json
{
  "name": "test",
  "region": "ap-1",
  "status": "Enabled",
  "creationDate": "2019-01-01T00:00:00Z",
  "recording": {
    "enable": true,
    "objectBucket": "test",
    "expireDays": 60,
    "segmentDuration": 5,
    "snapshot": {
      "enable": true,
      "interval": 10,
      "filename": "test",
      "format": "jpg",
      "expireDays": 60
    },
    "format": [
      "flv"
    ],
    "playbackDomain": "127.0.0.1"
  },
  "forward": {
    "enable": false,
    "items": [
      {
        "domain": "http://qiniuapi.com",
        "url": "http:qiniuapi.com/lixv"
      },
      {
        "domain": "http://qiniuapi.com",
        "url": "http:qiniuapi.com/lixv"
      }
    ]
  },
  "codec": {
    "convert": [
      ""
    ],
    "passive": [
      ""
    ]
  },
  "origin": {
    "enable": true,
    "type": "",
    "url": "http:qiniuapi.com/lixv",
    "urlBackup": "",
    "timeout": 60,
    "retryTimes": 3,
    "followISP": true
  },
  "redirect": 100,
  "callbackEnable": true,
  "streamConf": {
    "lastModified": "2019-01-01T00:00:00Z",
    "gopCacheMode": 10,
    "gopCacheNum": 10,
    "enableTimestampModify": true,
    "disableHttpChunk": true,
    "noDataTimeout": 60,
    "hlsType": 10,
    "hlsSegmentDuration": 10,
    "hlsSegmentExpired": 10,
    "enableDelayPlay": true,
    "expectedDelayTimeSecond": 10,
    "disablePublisherBattle": true,
    "enableBackupPublish": false
  },
  "refererSecurity": {
    "type": "white",
    "list": [
      "",
      ""
    ],
    "includeEmpty": true
  },
  "lastModified": "2019-01-01T00:00:00Z",
  "connectId": "QXV0aG9yaXphdGlvbg",
  "callbackUrl": "www.example.com",
  "urlRewrites": [
    {
      "pattern": "",
      "replace": ""
    }
  ]
}
```
### 响应参数
| 参数名称 | 类型 | 说明 | 是否必需 |
|:------|:------|:------|:----------|
| name | string | 空间名称 | 必需 |
| region | string | 区域 | 必需 |
| status | string | 状态 | 必需 |
| creationDate | string | 创建时间 | 必需 |
| recording | object |  | 可选 |
| ├─ enable | boolean | 是否开启录制功能 | 必需 |
| ├─ objectBucket | string | 录制文件保存对象空间 | 必需 |
| ├─ expireDays | integer | 录制过期时间，默认不过期 | 必需 |
| ├─ segmentDuration | integer | 录制切片时长，默认 5s | 必需 |
| ├─ format | []string | 录制格式 | 必需 |
| └─ snapshot | object |  | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ enable | boolean | 是否开启截图 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ interval | integer | 截图间隔，单位秒 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ filename | string | 截图文件名 | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ format | string | 截图格式（jpg/png） | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ expireDays | integer | 截图过期时间，默认不过期 | 必需 |
| playbackDomain | string | 回放域名 | 必需 |
| forward | object |  | 可选 |
| ├─ enable | boolean |  | 必需 |
| └─ items | object |  | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;├─ url | string | 转发到此 URL | 必需 |
| &nbsp;&nbsp;&nbsp;&nbsp;└─ domain | string | 转发到此域名 | 必需 |
| codec | object | 转码配置 | 可选 |
| ├─ convert | []string | 实时转码模板（有推流即启动） | 必需 |
| └─ passive | []string | 触发转码模板（首次拉流启动） | 必需 |
| origin | object |  | 可选 |
| ├─ enable | boolean | 是否开启回源 | 必需 |
| ├─ type | string | 回源类型 | 必需 |
| ├─ url | string | 回源地址 | 必需 |
| ├─ urlBackup | string | 备用回源地址 | 必需 |
| ├─ retryTimes | integer | 回源重试次数 | 必需 |
| ├─ followISP | boolean | 是否跟随 ISP 策略 | 必需 |
| └─ timeout | integer | 回源超时时间 | 必需 |
| callbackEnable | boolean |  | 必需 |
| callbackUrl | string |  | 必需 |
| streamConf | object | 流媒体参数配置 | 可选 |
| ├─ gopCacheMode | integer | GOP 缓存模式（0: 秒开, 1: 低延迟, 2: LAS） | 可选 |
| ├─ gopCacheNum | integer | 缓存 GOP 数目 | 可选 |
| ├─ noDataTimeout | integer | 无数据超时断开推流（秒） | 可选 |
| ├─ enableTimestampModify | boolean | 是否开启时间戳修改 | 可选 |
| ├─ disableHttpChunk | boolean | 是否取消 FLV Chunk 模式 | 可选 |
| ├─ hlsType | integer | HLS 服务模式 (2: 中心切片, 3: 边缘切片) | 可选 |
| ├─ hlsSegmentDuration | integer | HLS 切片大小（秒） | 可选 |
| ├─ hlsSegmentExpired | integer | HLS 切片缓存时间（秒），默认 4 × segment duration | 可选 |
| ├─ enableDelayPlay | boolean | 是否允许延时播放 | 可选 |
| ├─ expectedDelayTimeSecond | integer | 默认延时播放时长 | 可选 |
| ├─ disablePublisherBattle | boolean | 是否开启抢流（默认 false，启用抢流） | 可选 |
| ├─ enableBackupPublish | boolean | 是否开启主备流（默认 false） | 必需 |
| └─ lastModified | string  | 最后修改时间 | 必需 |
| refererSecurity | object |  | 必需 |
| ├─ type | string | "black" 黑名单 / "white" 白名单 / "" 关闭鉴权 | 必需 |
| ├─ includeEmpty | boolean | | 必需 |
| └─ list | []string |  | 必需 |
| urlRewrites | []object |  | 必需 |
| ├─ pattern | string |  | 必需 |
| └─ replace | string |  | 必需 |
| connectId | string | | 必需 |
| lastModified | string |  | 必需 |


