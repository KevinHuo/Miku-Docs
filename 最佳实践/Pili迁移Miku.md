# ä» Pili è¿ç§»åˆ° Mikuï¼ˆMikuStreamï¼‰æŒ‡å—

## âš ï¸ è¿ç§»å‰æ³¨æ„äº‹é¡¹

åœ¨å¼€å§‹è¿ç§»ä¹‹å‰ï¼Œè¯·æ³¨æ„ä»¥ä¸‹é‡è¦äº‹é¡¹ï¼š

- **æµ·å¤–åŸŸåé™åˆ¶**ï¼šå½“å‰æš‚ä¸æ”¯æŒè¦†ç›–æµ·å¤–åŒºåŸŸçš„åŸŸåè¿ç§»ï¼Œè¯·è”ç³»å®¢æœè·å–è§£å†³æ–¹æ¡ˆ
- **æ¨æµ SDK å…¼å®¹æ€§**ï¼šåŸ Pili æ¨æµ SDK åœ¨ Miku æš‚ä¸å…¼å®¹ï¼Œè¯·æå‰ç¡®è®¤å…¼å®¹æ€§
- **æ§åˆ¶å°æ“ä½œé™åˆ¶**ï¼šç›®å‰äº‘å¯¼æ’­å’Œ Pub è½¬æ¨åŠŸèƒ½å°šæœªå¼€æ”¾ APIï¼Œéœ€é€šè¿‡æ§åˆ¶å°æ‰‹åŠ¨æ“ä½œ

> ğŸ“Œ **æ“ä½œæŒ‡å¼•**ï¼š
> - å¯¼æ’­å°ï¼šhttps://portal.qiniu.com/mikustream/caster
> - Pub è½¬æ¨ï¼šhttps://portal.qiniu.com/mikustream/pub/tasks

# è¿ç§»æ­¥éª¤è¯¦è§£

## 1. åˆ›å»ºç›´æ’­ç©ºé—´

1. ç™»å½• [Miku æ§åˆ¶å°](https://portal.qiniu.com/mikustream/buckets)
2. æ–°å»ºç›´æ’­ç©ºé—´

![æ–°å»ºç›´æ’­ç©ºé—´](https://docs.qnsdk.com/miku_8f3c91b2e7d04a8fbe4a2ddc9c1d57af.png)

## 2. åŸŸåç»‘å®š

å°†åŸ Pili æ¨æ‹‰æµåŸŸåè¿ç§»è‡³ Miku å¹³å°

![ç»‘å®šåŸŸå](https://docs.qnsdk.com/miku_d1f47c9ab2384e79a4c6e1f50b8f94e2.png)

> ğŸ“‹ **å¤‡æ¡ˆè¦æ±‚**ï¼šç›´æ’­åŸŸåéœ€å®Œæˆ ICP å¤‡æ¡ˆå’Œå…¬å®‰å¤‡æ¡ˆã€‚å¦‚ä¸ç¡®å®šå¤‡æ¡ˆæµç¨‹ï¼Œè¯·å‚è€ƒ[å¤‡æ¡ˆå¸®åŠ©æ–‡æ¡£](https://developer.qiniu.com/af/kb/3987/how-to-make-website-and-inquires-the-police-put-on-record-information)

## 3. CNAME é…ç½®

1. è·å– Miku å¹³å°åˆ†é…çš„åŸŸåå’Œ CNAME
2. åœ¨æ‚¨çš„ DNS ç®¡ç†å¹³å°é…ç½®è¯¥ CNAME è®°å½•

![cname](https://docs.qnsdk.com/miku_7ab39d84c2ef4a46b1da3f9c0e5d17bf.png)

## 4. å½•åˆ¶é…ç½®

![å½•åˆ¶è®¾ç½®](https://docs.qnsdk.com/miku_3f9a7be214df4962a8730bc59d42e8aa.png)

> âš ï¸ **é‡è¦æç¤º**ï¼šä¸ Pili ä¸åŒï¼ŒMiku å½“å‰æš‚ä¸æ”¯æŒå­˜å‚¨è¿‡æœŸæ—¶é—´è®¾ç½®

## 5. æ¨æµé‰´æƒè¿ç§»

å¦‚åŸ Pili é…ç½®äº†æ¨æµé‰´æƒï¼Œè¿ç§»è‡³ Miku æ—¶éœ€è°ƒæ•´ç­¾åç®—æ³•ã€‚å…·ä½“æ–¹æ³•è¯·å‚è€ƒï¼š[Miku é‰´æƒæ–‡æ¡£](https://developer.qiniu.com/mikustream/13172/mikustream-live-authentication)

## 6. æ‹‰æµé‰´æƒè¿ç§»

å¦‚åŸ Pili é…ç½®äº†æ‹‰æµé‰´æƒï¼Œä»…éœ€å°†è¿‡æœŸæ—¶é—´å‚æ•°ä» 16 è¿›åˆ¶è°ƒæ•´ä¸º 10 è¿›åˆ¶ï¼Œå…¶ä½™é€»è¾‘ä¿æŒä¸å˜ã€‚

**PILI:**
![PILI](https://docs.qnsdk.com/miku_ae49c0d13f7b45c0b82e5f4d09a8c73d.png)

**MIKU:**
![MIKU](https://docs.qnsdk.com/miku_59e4c3ab7fdc49f88a3b15d607e1c4fb.png)

## 7. åˆ›å»ºç›´æ’­æµ

![åˆ›å»ºç›´æ’­æµ](https://docs.qnsdk.com/miku_7d9b2e14c0fa4c0db8135ff92a6d3b8c.png)

ç”Ÿæˆæ¨æµåœ°å€å’Œæ‹‰æµåœ°å€ç”¨äºç›´æ’­æ¨æµå’Œè§‚çœ‹

## æ¨æ‹‰æµåœ°å€æ ¼å¼

**Miku æ¨æµåè®®æ”¯æŒï¼š**
```
# RTMP æ¨æµ
rtmp://<domain>/<bucket>/<stream>

# SRT æ¨æµ
srt://<domain>:1935?streamid=#!::h=<bucket>/<stream>,m=publish,domain=<domain>

# WHIP æ¨æµ
https://<domain>/<bucket>/<stream>.whip
```

**Miku æ‹‰æµåè®®æ”¯æŒï¼š**
```
# RTMP æ‹‰æµ
rtmp://<domain>/<bucket>/<stream>

# WHIP æ‹‰æµ
http://<domain>/<bucket>/<stream>.whep

# HLS æ‹‰æµ
http://<domain>/<bucket>/<stream>.m3u8

# FLV æ‹‰æµ
http://<domain>/<bucket>/<stream>.flv

# SRT æ‹‰æµ
srt://<domain>:1935?streamid=#!::h=<bucket>/<stream>,m=request,domain=<domain>
```

> ğŸ’¡ **æ€§èƒ½ä¼˜åŒ–å»ºè®®**ï¼šç»æµ‹è¯•ï¼ŒMiku ä½¿ç”¨ FLV æ ¼å¼æ’­æ”¾æ€§èƒ½æœ€ä¼˜

## é«˜çº§åŠŸèƒ½è¯´æ˜

### URL é‡å†™è§„åˆ™

Pili é‡‡ç”¨ break æ¨¡å¼ï¼ˆåŒ¹é…å³ç»ˆæ­¢ï¼‰ï¼Œè€Œ Miku é‡‡ç”¨ continue æ¨¡å¼ï¼ˆåŒ¹é…åç»§ç»­ï¼‰ï¼Œä½¿ç”¨ URL é‡å†™æ—¶éœ€ç‰¹åˆ«æ³¨æ„æ­¤å·®å¼‚

### è‡ªåŠ¨å½•åˆ¶è®¾ç½®

å¦‚éœ€å¼€å¯è‡ªåŠ¨å½•åˆ¶åŠŸèƒ½ï¼Œéœ€é€šè¿‡ API é…ç½®ã€‚è¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒï¼š[ç©ºé—´é…ç½®æ›´æ–°API](https://developer.qiniu.com/mikustream/13096/mikustream-live-bucket-config-update-api)

# æœåŠ¡ç«¯ API è¿ç§»æŒ‡å—

API è¯¦ç»†æ–‡æ¡£è¯·å‚è€ƒï¼š[Miku API æ¦‚è§ˆ](https://developer.qiniu.com/mikustream/12890/mikustream-live-an-overview-of-the-api)

## ğŸ”„ æ¥å£åŸŸåæ›¿æ¢

- **ç›´æ’­ç©ºé—´ç®¡ç†**ï¼š`pili.qiniuapi.com` â†’ `mls.cn-east-1.qiniumiku.com`
- **åŠŸèƒ½æ¥å£**ï¼š`pili.qiniuapi.com` â†’ `<bucket>.mls.cn-east-1.qiniumiku.com`

## ğŸ”‘ é‰´æƒæ–¹æ¡ˆé€‰é¡¹

### æ–¹æ¡ˆ Aï¼šAK/SKï¼ˆQiniuTokenï¼‰

- å¯å¤ç”¨ç°æœ‰ Pili ç­¾åä»£ç 
- ä¿®æ”¹ç­¾åä¸²å’Œ Host ä¸º `mls.<region>.qiniumiku.com`
- [AK/SK è®¤è¯æ–‡æ¡£](https://developer.qiniu.com/mikustream/12893/mikustream-live-http-requests-authentication#2)

### æ–¹æ¡ˆ Bï¼šBearer API Key

1. åˆ›å»º API Keyï¼š`POST http://mls.<region>.qiniumiku.com/?apikey`
2. è¯·æ±‚é‰´æƒï¼š`Authorization: Bearer <Miku API Key>`
- [Bearer Token è®¤è¯æ–‡æ¡£](https://developer.qiniu.com/mikustream/12893/mikustream-live-http-requests-authentication#1)

### æ–¹æ¡ˆ Cï¼šIAM å­è´¦å·

- ä½¿ç”¨ `AccessKey: IAM-xxxx` + `SecretKey`
- ä¿æŒ QiniuToken ç­¾åæ–¹å¼
- [IAM è®¤è¯æ–‡æ¡£](https://developer.qiniu.com/mikustream/12893/mikustream-live-http-requests-authentication#3)

**å˜æ›´è¦ç‚¹ï¼š**
- IAM å­è´¦å·ä¸å†éœ€è¦ä¸“ç”¨åŸŸå `pili-iam.qiniuapi.com`
- AK/SK é‰´æƒä¸ Pili ä¿æŒä¸€è‡´
- æ–°å¢ Bearer Token æ”¯æŒ
- è¯¦è§ [API è¯·æ±‚é‰´æƒ](https://developer.qiniu.com/mikustream/12893/mikustream-live-http-requests-authentication)

# æ’­æ”¾å™¨é€‚é…è¯´æ˜

**åŸ Pili å¿«ç›´æ’­ç”¨æˆ·ï¼š**
- å‡çº§è‡³æœ€æ–°ç‰ˆ SDK
- æ›´æ–°æ’­æ”¾åœ°å€æ ¼å¼
- å…¶ä½™åŠŸèƒ½å¯é¡ºç•…è¿ç§»

---

# ğŸ“ æŠ€æœ¯æ”¯æŒæœåŠ¡

å¦‚æœ‰ä»»ä½•è¿ç§»é—®é¢˜æˆ–æŠ€æœ¯ç–‘é—®ï¼Œæ¬¢è¿è”ç³»æˆ‘ä»¬çš„æŠ€æœ¯æ”¯æŒå›¢é˜Ÿè·å–ä¸“ä¸šååŠ©ã€‚
